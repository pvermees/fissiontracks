rm(list=ls())
graphics.off()
source('semitracks.R')

example <- 2

if (example==1){
    fname <- 'data/fct_c_semi.csv'
    confined <- FALSE
    skip <- 0
} else if (example==2){
    fname <- 'data/UM10-10 Brogo 3D Semi Tracks with Dper.csv'
    confined <- FALSE
    skip <- 2
} else if (example==3){
    fname <- 'data/UM10-10 Brogo 3D Confined Lengths.csv'
    confined <- TRUE
    skip <- 2
} else if (example==4){
    fname <- 'data/30B1-30B2-16-LENGTH.csv'
    confined <- FALSE
    skip <- 4
}

# open the data file
dat <- read.data(fname,confined=confined,cutoff=3,skip=skip)

mcmc <- FALSE

fit <- invert(dat$l,confined=confined,ncomp=5)
x <- forward(fit$P,fit$M,fit$S)
plotModel(x,dat)
